import{addNotificacion as t}from"https://unpkg.com/notificaciones-w3css@1.0.1/notificaciones.js";import{descargarArchivo as e}from"https://unpkg.com/operaciones-archivos@1.0.2/operaciones-archivos.js";import{CodeJar as n}from"https://unpkg.com/codejar@3.5.0/codejar.js";import{withLineNumbers as o}from"https://unpkg.com/codejar@3.5.0/linenumbers.js";!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const n of t)if("childList"===n.type)for(const t of n.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerpolicy&&(e.referrerPolicy=t.referrerpolicy),"use-credentials"===t.crossorigin?e.credentials="include":"anonymous"===t.crossorigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();let i=document.querySelector("#guardar");function r(){const e=a();let n=LZString.compressToBase64(JSON.stringify(e));localStorage.setItem("documento",n),i.classList.remove("cambio"),t({tipo:"w3-indigo",titulo:"&#10004; Ok",mensaje:"Se guardó correctamente el documento"})}function a(){let t=z();const[e,n,o]=t.getTodoElCodigo(),i=document.querySelector("input.autor"),r=document.querySelector("input.titulo");return{autor:i.value,titulo:r.value,fecha:Date.now(),codigo:[e,n,o]}}function l(t){let e=document.querySelector("input.autor"),n=document.querySelector("input.titulo");e.value=t.autor,n.value=t.titulo}let s=localStorage.getItem("split-sizes");function c(){let t=document.querySelector(".vista-previa");const e=`${t.clientWidth} x ${t.clientHeight}`;document.querySelector("#size").innerHTML=e}s=s?JSON.parse(s):[50,50],Split(["#tabs-jar","#panel"],{sizes:s,minSize:400,gutterSize:8,onDragEnd:function(t){localStorage.setItem("split-sizes",JSON.stringify(t))},onDrag:function(){c()}}),window.addEventListener("resize",(()=>{c()}));let d=null,u=null,p={};function m(t){let e="";for(let n in t){let o=t[n];null==o||null==o?e+=`<p><span class="key">${n}</span>: <span class="numero">${o}</span></p>`:"object"==typeof o&&null!=o&&null!=o?e+=`<details>\n\t<summary>${n}: <span class="tipo">${o.constructor.name}</span></summary>\n\t${m(o)}\n</details>\n\t\t\t`:"number"==typeof o?e+=`<p><span class="key">${n}</span>: <span class="numero">${o}</span></p>`:"string"==typeof o?e+=`<p><span class="key">${n}</span>: <span class="cadena">"${o}"</span></p>`:"function"==typeof o&&(e+=`<p><span class="key">${n}</span>: <span class="funcion"> funcion()</span></p>`)}return e}function h(t){return m({objecto:t})}function b(t,e){e.style.visibility="hidden",t.style.visibility="visible",t.style.height="600px"}function f(t,e){t.style.height="0",t.style.visibility="hidden",e.style.visibility="visible"}function g(){d||console.warn("Defina el div contenedor de la consola")}function v(t,e){let n=document.createElement("div");n.classList.value=t,n.innerHTML=function(t){let e="";for(let n of t)null==n||null==n?e+=`<span class="numero">${n}</span>&nbsp;`:"object"==typeof n?n instanceof Date?e+=n:n&&(e+=h(n)):"number"==typeof n?e+=`<span class="numero">${n}</span>&nbsp;`:"string"==typeof n?e+=`<span class="cadena">${n}</span>&nbsp;`:"function"==typeof n&&(e+='<span class="funcion">funcion()</span>');return e}(e),d.append(n),d.scrollTop=d.scrollHeight-d.clientHeight}function y(...t){g(),v("linea",t)}function w(t){let n=z();t.onkeydown=function(t){return t.ctrlKey&&"s"===t.key.toLowerCase()?(r(),!1):t.ctrlKey&&"d"===t.key.toLowerCase()?(function(t){const[n,o,i]=t.getTodoElCodigo(),r=document.querySelector("input.titulo").value,a=k(n,o,i);e(a,`${r}.html`,"text/html")}(n),!1):t.ctrlKey&&"1"===t.key?(n.activaTabPorIndice(0),!1):t.ctrlKey&&"2"===t.key?(n.activaTabPorIndice(1),!1):t.ctrlKey&&"3"===t.key?(n.activaTabPorIndice(2),!1):t.ctrlKey&&"4"===t.key?(function(){let t=u.shadowRoot.querySelector(".footer"),e=u.shadowRoot.querySelector(".main");console.log(e.style.visibility),"hidden"===e.style.visibility?b(e,t):f(e,t)}(),!1):t.ctrlKey&&">"===t.key?(n.incrementaTamanio(),!1):t.ctrlKey&&"<"===t.key?(n.decrementaTamanio(),!1):t.ctrlKey&&"m"===t.key.toLowerCase()?(function(){const t=`${location.protocol}//${location.host}${location.pathname}`;window.open(t+"#N4IghgrgLg9gTiAXOa8QBoRQJZQgGxiRABVcCjMAzAUwGMALMJARgDYBmABjYBZ+WLAOy8WmOjAAm2AOZFEAbRAZlmEAF0AvkA==","_blank")}(),!1):t.ctrlKey&&"k"===t.key.toLowerCase()?(n.swapTema(),!1):t.ctrlKey&&"e"===t.key.toLowerCase()?(J(),!1):void 0}}function S(t){t.contentWindow.console.error=(...t)=>{!function(...t){g(),v("linea error",t)}(...t)},t.contentWindow.console.log=y}let x=document.querySelector("#guardar");function k(t,e,n){return`\n    <!DOCTYPE html>\n    <html lang="en">\n    <head>\n        <meta charset="UTF-8">\n        <meta name="viewport" content="width=device-width, initial-scale=1.0">\n        <title>Document</title>\n    </head>\n    <style>\n        ${e}\n    </style>\n    <body>\n        ${t}\n    </body>    \n    <script type="module">\n        ${n}\n    <\/script>\n    </html>\n    `}let L={forin:!0,noarg:!0,bitwise:!0,nonew:!0,browser:!0,devel:!0,node:!1,moz:!1,eqnull:!1,debug:!1,boss:!1,evil:!0,loopfunc:!1,varstmt:!0,esversion:8,undef:!0,unused:!0,curly:!0};function E(t,e){let n=t.split("\n");const o=e.line-1;let i=0==e.code.indexOf("E")?"error":"warning";return n[o]=`<span class="linea-${i}" title="${e.reason}">${n[o]}</span>`,n.join("\n")}function T(t,e){return e?o(t):t}const $={claro:"https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.2.0/build/styles/mono-blue.min.css",oscuro:"https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.2.0/build/styles/base16/edge-dark.min.css"};class j extends HTMLElement{constructor(){super(),this.files=[],this.contadorTab=0,this.editoresJar=[],this.tema="oscuro",this.variablesEditor={alto:"100vh",colorSeleccion:"white",fondoSeleccion:"#446294",tamanioLetra:10}}getTodoElCodigo(){let t=[];for(let e of this.editoresJar)t.push(e.jar.toString());return t}emiteCambio(t,e){let n=new CustomEvent("cambio-editor",{detail:{target:t,codigo:e}});this.dispatchEvent(n)}emiteclipIcono(t,e){let n=new CustomEvent("click-icono",{detail:{target:t,index:e-1}});this.dispatchEvent(n)}swapTema(){"claro"==this.tema?this.setTema("oscuro"):this.setTema("claro")}setTema(t){this.tema=t,this.querySelector("#temacolor").setAttribute("href",$[this.tema])}creaTab(t,e,n){let o=document.createElement("button");this.tabs.append(o),o.innerHTML=`<span icono>${e}</span> ${t}`,o.id=`tab-${n}`,o.setAttribute("tab","");let i=o.querySelector("[icono]");return i.addEventListener("click",(t=>this.emiteclipIcono(i,n))),o}creaEditor(t,e){let o=document.createElement("div");this.editores.append(o),o.innerHTML=`<div id="file+${e}" class="editor hljs language-${t.tipo}"></div>`,o.classList.add("contenedor-"+e),o.setAttribute("contenedor","");let i=function(t,e,o=null,i=!0){return n(t,T(null==o?t=>{t.textContent=t.textContent;let n=t.textContent,o=hljs.highlight(n,{language:e}).value;t.innerHTML=o}:o,i))}(o.querySelector("div"),t.tipo,t.fcolor,t.numLinea);return i.updateCode(t.codigo),{editor:o,jar:i}}remueveActivo(t){let e=this.querySelectorAll(t);for(let n of e)n.classList.remove("activo")}activa(t,e){this.remueveActivo("[tab]"),this.remueveActivo("[contenedor]"),t.classList.add("activo"),e.classList.add("activo")}addListenersTabEditor(t,e){t.addEventListener("click",(n=>{this.activa(t,e)}))}getMetadataFile(){return{titulo:"",tipo:"",codigo:"",icono:"",fcolor:null,numLinea:!0}}activaTabPorIndice(t=0){let e=this.querySelector("#tab-"+t),n=this.querySelector(".contenedor-"+t);if(e&&n){this.activa(e,n),n.querySelector(".editor").focus()}}addEventosEditoresJar(){for(let t of this.editoresJar)t.jar.onUpdate((e=>{this.emiteCambio(t.editor,e)}))}render(){this.innerHTML=`\n        <link rel="stylesheet" href="${$[this.tema]}" id="temacolor">\n        <style variables>        \n        </style>\n        <style>\n        \n/**host */\n\n.editor {   \n    font-family: "Source Code Pro", monospace;\n    font-size: var(--tamanio-letra);\n    font-weight: 400;\n    min-height: 240px;\n    letter-spacing: normal;\n    line-height: 20px;\n    padding: 10px;\n    tab-size: 4;\n    height: var(--alto);\n    overflow: auto;\n    resize: none;\n    line-height: 1.3;    \n}\n[contenedor] {\n    display: none;\n}\n\n.activo {\n    display: block;\n}\n.tabs {\n    overflow: hidden;    \n    position: sticky;\n    top: 0;\n    z-index: 1;\n}\n.tabs button{\n    background-color: inherit;\n    float: left;\n    border: none;\n    outline: none;\n    cursor: pointer;\n    padding: 4px 5px;\n    transition: 0.3s;    \n    filter: contrast(50%);\n}\n\n.tabs button img{\n    width: 18px;\n    height: 18px;\n}\n\n.tabs button:hover {    \n    filter: contrast(100%);\n}\n\n.tabs button.activo {    \n    filter: contrast(100%);\n}\n\n.codejar-linenumbers > div {\n    filter: invert(1);\n}\n.linea-error{    \n    color: white;\n    background-color: red;\n    border: solid 1px #902d2d;\n    padding-left: 2px;\n    padding-right: 2px;\n    background-color: #907c7c;\n}\n.linea-error::before{\n    content: '\\25B6 ';\n    color: red;\n}\n.linea-warning{    \n    color: white;\n    background-color: orange;\n    border: solid 1px #902d2d;\n    padding-left: 2px;\n    padding-right: 2px;\n    background-color: #907c7c;\n}\n.linea-warning::before{\n    content: '\\25B6 ';\n    color: orange;\n}\ndiv[class*="editor"] span::selection, div[class*="editor"]::selection {\n    color: var(--color-seleccion);\n    background: var(--fondo-seleccion);\n}\n\n\n        </style>\n        \n<div class="variables">\n    <div class="tabs hljs">\n    </div>\n    <div class="editores">    \n    </div>\n</div>\n\n        `,this.contadorTab=0,this.editoresJar=[],this.tabs=this.querySelector(".tabs"),this.variables=this.querySelector("[variables]"),this.seteaVariables(),this.editores=this.querySelector(".editores");for(let t of this.files){let e=this.getMetadataFile();e=Object.assign(e,t);let n=this.creaTab(e.titulo,e.icono,this.contadorTab),o=this.creaEditor(e,this.contadorTab);this.addListenersTabEditor(n,o.editor),this.editoresJar.push(o),0==this.contadorTab&&this.activa(n,o.editor),this.contadorTab++}this.addEventosEditoresJar()}seteaVariables(){this.variables.innerHTML=`\n            .variables {\n                --alto: ${this.variablesEditor.alto};\n                --color-seleccion: ${this.variablesEditor.colorSeleccion};\n                --fondo-seleccion: ${this.variablesEditor.fondoSeleccion};\n                --tamanio-letra: ${this.variablesEditor.tamanioLetra}pt;\n            }\n        `}setAlto(t="100vh"){this.variablesEditor.alto=t,this.seteaVariables()}incrementaTamanio(){this.variablesEditor.tamanioLetra++,this.seteaVariables()}decrementaTamanio(){this.variablesEditor.tamanioLetra--,this.variablesEditor.tamanioLetra<6&&(this.variablesEditor.tamanioLetra=6),this.seteaVariables()}setColorSeleccion(t="white"){this.variablesEditor.colorSeleccion=t,this.seteaVariables()}setFondoSeleccion(t="#446294"){this.variablesEditor.fondoSeleccion=t,this.seteaVariables()}setFiles(t){this.files=t,this.render()}}customElements.define("editor-archivos-codejar",j);let q=document.querySelector("editor-archivos-codejar"),A=document.querySelector(".vista-previa"),[C,O,H]=["","",""],M=location.href.split("#")[1];if(M){let t=JSON.parse(LZString.decompressFromBase64(M));l(t),[C,O,H]=t.codigo}else{let t=localStorage.getItem("documento");if(t){let e=JSON.parse(LZString.decompressFromBase64(t));l(e),[C,O,H]=e.codigo}}q.setFiles([{titulo:"HTML",tipo:"html",codigo:C,icono:"&#9733;"},{titulo:"CSS",tipo:"css",codigo:O,icono:"&#9733;"},{titulo:"Js",tipo:"js",codigo:H,fcolor:t=>{t.textContent=t.textContent;let e=t.textContent,n=hljs.highlight(e,{language:"js"}).value;n=function(t,e){JSHINT(e,L);let n=JSHINT.data();if(n.hasOwnProperty("errors"))for(let o of n.errors)t=E(t,o);return t}(n,e),t.innerHTML=n},icono:"&#9733;"}]);function J(){!function(t,e,n){let[o,i,r]=t.getTodoElCodigo();x.classList.add("cambio"),e.innerHTML="<iframe></iframe>";let a=e.querySelector("iframe");S(a);let l=k(o,i,r);a.contentDocument.open();try{a.contentDocument.write(l)}catch(s){console.log(s)}finally{a.contentDocument.close()}w(a.contentWindow)}(q,A)}function z(){return q}window.addEventListener("resize",(t=>{q.setAlto(window.innerHeight-95+"px")})),q.setAlto(window.innerHeight-95+"px"),q.addEventListener("cambio-editor",(t=>{})),J(),c();let I=document.querySelector(".consola");p={colorString:"black"},function(t){t.attachShadow({mode:"open"}),t.shadowRoot.innerHTML=`\n        <style>\n        \n.main{  \n    visibility: hidden;  \n    background: white;\n    position: fixed;\n    width: 400px;\n    max-height: 600px;\n    height: 0px;\n    bottom: 5px;\n    right: 0;    \n    border: solid 1px black;\n    overflow-y: visible;\n    transition: height 0.5s;\n}\n.footer{\n    padding-left: 5px;\n    position: fixed;\n    background: #009688;\n    bottom: 5px;\n    right: 0;\n    border: solid 1px black;\n    width: 400px;\n    height: 18px;\n    color: white;\n}\n.linea {\n\tmargin-top: 4px;\n    font-size: 11px;\n    font-family: monospace;\n    display: flex;\n    border-bottom: solid 1px var(--color-linea);\n\t\n}\n\n.error {\n\tbackground-color: var(--fondo-error);\n}\n.warning {\n\tbackground-color: var(--fondo-warning);\n}\n\n.console {\n    counter-reset: numlinea;\n}\n\n.linea::before {\n    counter-increment: numlinea;\n    content: "[" counter(numlinea) "]: ";    \n    font-weight: bold;\n    width: 50px;\n}\n\ndetails {\n\tmargin-left: 15px;\n\tfont-family: monospace;\t\n}\ndetails > summary {\n\tlist-style-type: none;\n    padding-left: 4px;\n    width: 200px;    \n    border: none;\n    cursor: pointer;\n}\n\ndetails > summary > .tipo {\n\tcolor: var(--color-tipo);\n}\n\ndetails > p {    \n    padding: 4px;\n    margin: 0;\n    margin-left: 15px;\n}\n\ndetails > p > .key {\n    color: var(--color-key);;\n}\n\ndetails > p > .objecto {\n    color: var(--color-objecto);;\n}\n\ndetails > p > .cadena, .linea > .cadena {\n    color: var(--color-string);\n}\ndetails > p > .numero, .linea > .numero {\n    color: var(--color-numero);\n}\n\ndetails > p > .funcion, .linea > .funcion {\n    color: var(--color-tipo);\n}\n\ndetails > summary::before {\n    content: var(--simbolo-expandir);\n    color: blue;\n}\n\ndetails[open] > summary::before {\n    content: var(--simbolo-contraer);\n    color: red;\n}\n.console{\n    overflow-y: auto;\n    max-height: 560px;\n    height: 560px;\n    max-width: 400px;\n}\n.encabezado-consola{\n    border-bottom: 1px solid black;\n    height: 18px;\n    background: #009688;\n    color: white;\n}\n.titulo{\n    float: left;\n    margin-left: 5px;\n}\n.acciones{\n    float: right;\n    margin-right: 5px;\n}\n.acciones > span {\n    border: solid 1px black;\n    font-size: 12px;\n    cursor: pointer;\n    color: black;\n    background-color: white;\n}\n\n.acciones > span:hover {    \n    color:blue;\n}\n\n        </style>\n        \n        <style>\n        ${function(){let t=Object.assign({colorNumero:"blue",colorString:"red",colorKey:"purple",colorTipo:"blue",colorObjecto:"black",colorLinea:"#eee",fondoError:" #f3babf",fondoWarning:"#f3dfba",simboloExpandir:"+ ",simboloContraer:"- "},p);return`\n.variables{\n    --color-numero: ${t.colorNumero};\n    --color-string: ${t.colorString};\n    --color-key: ${t.colorKey};\n    --color-tipo: ${t.colorTipo};\n    --color-objecto: ${t.colorObjecto};\n    --color-linea: ${t.colorLinea};\n    --fondo: ${t.fondo};\n    --fondo-warning: ${t.fondoWarning};\n\t--fondo-error: ${t.fondoError};\n\t--simbolo-expandir: "${t.simboloExpandir}";\n\t--simbolo-contraer: "${t.simboloContraer}";\n}\n    `}()}\n        </style>\n\t\t<div class="variables main" style="height: 0px; visibility: hidden;">\n\t\t\t<div class="encabezado-consola">\n\t\t\t\t<div class="titulo">Logger</div> \n\t\t\t\t<div class="acciones">\n\t\t\t\t<span title="limpiar" id="limpiar">&empty;</span>\n\t\t\t\t<span title="cerrar" id="cerrar">&#x2B07;</span>\n\t\t\t\t</div>\t\t\t\t\n\t\t\t</div>\n            <div class="console"></div>\n\t\t</div>\n\t\t<div class="footer">\n\t\t<span class="show-consola">Logger</span>\n\t\t\t<div class="acciones">\n\t\t\t\t<span title="mostrar " id="show">&#x2B06;</span>\n\t\t\t</div>\t\t\n\t\t</div>\n\t`,u=t,d=t.shadowRoot.querySelector(".console");let e=t.shadowRoot.querySelector("span#limpiar"),n=t.shadowRoot.querySelector("span#show"),o=t.shadowRoot.querySelector("span#cerrar"),i=t.shadowRoot.querySelector(".footer");!function(t,e,n){let o=e.shadowRoot.querySelector(".main");t.addEventListener("click",(t=>{b(o,n)}))}(n,t,i),e.addEventListener("click",(t=>{d.innerHTML=""})),function(t,e,n){let o=e.shadowRoot.querySelector(".main");t.addEventListener("click",(t=>{f(o,n)}))}(o,t,i)}(I),y('<h2 style="color: indigo;">Logger beta</h2>\n<h4>by Saúl SM</h4>'),document.querySelector("#compartir").addEventListener("click",(e=>{let n=a(),o=`${location.protocol}//${location.host}${location.pathname}`;o+="#"+LZString.compressToBase64(JSON.stringify(n)),navigator.clipboard.writeText(o).then((e=>{t({tipo:"w3-green",titulo:"&#10004; Ok",mensaje:"Se copió la url para compartir"})}))})),document.querySelector("#guardar").addEventListener("click",(t=>{r()}));document.querySelector("#ayuda").addEventListener("click",(e=>{t({tipo:"w3-white",titulo:"&#x261B; Comandos",mensaje:'\n<div class="w3-padding" style="max-height: calc(100vh / 2); overflow: auto;"> \n    <table class="w3-table-all">\n    \n    <tr>\n        <th colspan="2">Editor</th>       \n    </tr>\n    <tr>\n      <td>ctrl + m</td>\n      <td>Abre un nuevo documento en blanco.</td>      \n    </tr>\n    <tr>\n      <td>ctrl + s</td>\n      <td>Guardar el código en el explorador.</td>      \n    </tr>\n    <tr>\n      <td>ctrl + e</td>\n      <td>Ejecutar.</td>      \n    </tr>\n    <tr>\n      <td>ctrl + k</td>\n      <td>Intercambiar tema de editor.</td>      \n    </tr>\n    <tr>\n      <td>ctrl + d</td>\n      <td>Descarga el contenido un archivo html.</td>      \n    </tr>\n    <tr>\n      <td>ctrl + &lt;</td>\n      <td>Decrementa la letra de los editores.</td>      \n    </tr>\n    <tr>\n      <td>ctrl + &gt;</td>\n      <td>Incrementa la letra de los editores.</td>      \n    </tr>\n\n    \n    <tr>\n    <th colspan="2">Focus</th>    \n    </tr>\n    <tr>\n      <td>ctrl + 1</td>\n      <td>Activa el editor html.</td>      \n    </tr>\n    <tr>\n      <td>ctrl + 2</td>\n      <td>Activa el editor css.</td>      \n    </tr>\n    <tr>\n      <td>ctrl + 3</td>\n      <td>Activa el editor js.</td>      \n    </tr>\n    <tr>\n      <td>ctrl + 4</td>\n      <td>Activa la consola.</td>      \n    </tr> \n  \n    </table>  \n</div>\n\n\n',tiempo:5e4})})),document.querySelector("#codepen").addEventListener("click",(t=>{!function(){let t=document.createElement("div");t.innerHTML='\n    <form action="https://codepen.io/pen/define" \n    method="POST" target="_blank">\n      <input id="data-input" type="hidden" name="data" value="">\n    <button type=submmit>\n    enviar\n    </button>\n    </form>\n    ';let e=t.querySelector("form"),n=e.querySelector("input"),o=a();n.value=JSON.stringify({title:o.titulo,html:o.codigo[0],css:o.codigo[1],js:o.codigo[2]}),document.body.append(e),e.querySelector("button").click(),setTimeout((t=>{e.remove()}),1)}()})),document.querySelector("#run").addEventListener("click",(()=>{J()})),w(window);
